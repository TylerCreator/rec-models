# –°–∏—Å—Ç–µ–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ DAG

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è **8 –º–æ–¥–µ–ª–µ–π** –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞—Ñ–∞ DAG (Directed Acyclic Graph).

**–í–µ—Ä—Å–∏—è:** 4.1 Personalized with Real Users  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**–ò—Å—Ç–æ—á–Ω–∏–∫ –º–æ–¥–µ–ª–µ–π:** [Awesome-Sequence-Modeling-for-Recommendation](https://github.com/HqWu-HITCS/Awesome-Sequence-Modeling-for-Recommendation)

## üÜï –ù–æ–≤–æ–µ –≤ –≤–µ—Ä—Å–∏–∏ 4.1 - –†–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏! üèÜ

‚ú® **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –†–ï–ê–õ–¨–ù–´–ï –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –¥–∞–Ω–Ω—ã—Ö:**
- **Real Owner IDs** - –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ –ø–æ–ª—è `owner` –≤ –¥–∞–Ω–Ω—ã—Ö
- **Automatic Table Ownership** - –¥–ª—è —Ç–∞–±–ª–∏—Ü owner –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ü–µ–ª–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- **User Embeddings** - –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –†–ï–ê–õ–¨–ù–´–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Personalized PageRank** - –≤–∞–∂–Ω–æ—Å—Ç—å —É–∑–ª–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –†–ï–ê–õ–¨–ù–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:** Personalized DAGNN —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ users: **0.7576 accuracy, 0.9105 nDCG** (+47% vs –±–∞–∑–æ–≤–æ–π!)  
üìÑ **–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:** —Å–º. [REAL_USERS_RESULTS.md](REAL_USERS_RESULTS.md)

## üìà –≠–≤–æ–ª—é—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### –í–µ—Ä—Å–∏—è 4.1 (–¢–µ–∫—É—â–∞—è) - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ üèÜ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –†–ï–ê–õ–¨–ù–´–ï owner –∏–∑ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ owner –¥–ª—è —Ç–∞–±–ª–∏—Ü
- ‚úÖ User embeddings –¥–ª—è –†–ï–ê–õ–¨–ù–´–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ Personalized PageRank –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- ‚úÖ Attention mechanism –¥–ª—è fusion user + context
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** **Accuracy 0.7576, nDCG 0.9105** üöÄ
- **–£–ª—É—á—à–µ–Ω–∏–µ:** +47% accuracy vs –±–∞–∑–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏!

### –í–µ—Ä—Å–∏—è 3.1 - –ì—Ä–∞—Ñ–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ üìä
- ‚úÖ PageRank, In/Out Degree
- ‚úÖ Betweenness, Closeness, Clustering
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.5152, nDCG 0.7893

### –í–µ—Ä—Å–∏—è 3.0 - –ë–∞–∑–æ–≤–∞—è üöÄ
- ‚úÖ 8 –º–æ–¥–µ–ª–µ–π —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (GNN, Attention, CNN, RNN)
- ‚úÖ –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π split
- ‚úÖ Early stopping
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.5152, nDCG 0.7893

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ](#–≤—Ö–æ–¥–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ)
- [–ú–æ–¥–µ–ª–∏](#–º–æ–¥–µ–ª–∏)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ó–∞–ø—É—Å–∫](#–∑–∞–ø—É—Å–∫)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã-–º–æ–¥–µ–ª–µ–π)
- [–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤](#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
- [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## üéØ –û–±–∑–æ—Ä

### –ó–∞–¥–∞—á–∞
–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤—ã–∑–æ–≤–æ–≤
- –°—Ç—Ä—É–∫—Ç—É—Ä—ã DAG –≥—Ä–∞—Ñ–∞ –∫–æ–º–ø–æ–∑–∏—Ü–∏–π —Å–µ—Ä–≤–∏—Å–æ–≤

### –ü–æ–¥—Ö–æ–¥
–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º 8 –º–æ–¥–µ–ª–µ–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
- üß† **GNN –º–æ–¥–µ–ª–∏ (3)**: –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≥—Ä–∞—Ñ–∞
- üéØ **Attention –º–æ–¥–µ–ª–∏ (1)**: self-attention –º–µ—Ö–∞–Ω–∏–∑–º
- üß± **CNN –º–æ–¥–µ–ª–∏ (1)**: –∫–æ–Ω–≤–æ–ª—é—Ü–∏–∏ –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- üîÑ **RNN –º–æ–¥–µ–ª–∏ (1)**: —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–µ—Ç–∏
- üìä **ML baseline (1)**: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML
- üìà **Simple baseline (1)**: —á–∞—Å—Ç–æ—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥

---

## üì• –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: `compositionsDAG.json`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:**
```json
[
  {
    "nodes": [
      {
        "id": "node_id_1",
        "mid": "service_123"  // ID —Å–µ—Ä–≤–∏—Å–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
      },
      {
        "id": "node_id_2"      // –ë–µ–∑ mid ‚Üí —Ç–∞–±–ª–∏—Ü–∞
      }
    ],
    "links": [
      {
        "source": "node_id_1",
        "target": "node_id_2"
      }
    ]
  },
  // ... –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
]
```

**–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π:**

- `nodes` - –º–∞—Å—Å–∏–≤ —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞:
  - `id` (—Å—Ç—Ä–æ–∫–∞) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —É–∑–ª–∞ –≤ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
  - `mid` (—á–∏—Å–ª–æ, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID —Å–µ—Ä–≤–∏—Å–∞. –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí —É–∑–µ–ª-—Ç–∞–±–ª–∏—Ü–∞

- `links` - –º–∞—Å—Å–∏–≤ —Ä—ë–±–µ—Ä –≥—Ä–∞—Ñ–∞:
  - `source` (—Å—Ç—Ä–æ–∫–∞) - ID —É–∑–ª–∞-–∏—Å—Ç–æ—á–Ω–∏–∫–∞
  - `target` (—Å—Ç—Ä–æ–∫–∞) - ID —É–∑–ª–∞-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏:

```json
{
  "nodes": [
    {"id": "1", "mid": 100},    // service_100
    {"id": "2", "mid": 200},    // service_200
    {"id": "3"}                 // table_3
  ],
  "links": [
    {"source": "1", "target": "2"},  // service_100 ‚Üí service_200
    {"source": "2", "target": "3"}   // service_200 ‚Üí table_3
  ]
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

1. **–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥—Ä–∞—Ñ** –∏–∑ JSON
   ```
   50 —É–∑–ª–æ–≤ (—Å–µ—Ä–≤–∏—Å—ã + —Ç–∞–±–ª–∏—Ü—ã)
   97 —Ä—ë–±–µ—Ä (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
   ```

2. **–ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø—É—Ç–∏** –∏–∑ DAG
   ```
   228 –ø—É—Ç–µ–π —Ä–∞–∑–ª–∏—á–Ω–æ–π –¥–ª–∏–Ω—ã
   –ü—Ä–∏–º–µ—Ä: [service_1 ‚Üí service_2 ‚Üí service_3 ‚Üí table_1]
   ```

3. **–°–æ–∑–¥–∞–µ—Ç –æ–±—É—á–∞—é—â–∏–µ –ø—Ä–∏–º–µ—Ä—ã**
   ```
   –ò–∑ –∫–∞–∂–¥–æ–≥–æ –ø—É—Ç–∏: (–∫–æ–Ω—Ç–µ–∫—Å—Ç) ‚Üí (—Å–ª–µ–¥—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å)
   –ü—Ä–∏–º–µ—Ä: [service_1, service_2] ‚Üí service_3
   
   –í—Å–µ–≥–æ: 107 –ø—Ä–∏–º–µ—Ä–æ–≤
   ‚îú‚îÄ Train: 74 –ø—Ä–∏–º–µ—Ä–∞
   ‚îî‚îÄ Test:  33 –ø—Ä–∏–º–µ—Ä–∞
   ```

4. **–í–µ–∫—Ç–æ—Ä–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ**
   - –î–ª—è ML –º–æ–¥–µ–ª–µ–π (RF): MultiLabelBinarizer ‚Üí –±–∏–Ω–∞—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞
   - –î–ª—è GNN –º–æ–¥–µ–ª–µ–π: –º–∞–ø–ø–∏–Ω–≥ –≤ –∏–Ω–¥–µ–∫—Å—ã —É–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞
   - –î–ª—è Sequential –º–æ–¥–µ–ª–µ–π (SASRec, Caser, GRU4Rec): padding –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

```
–ì—Ä–∞—Ñ:
  ‚îú‚îÄ –£–∑–ª–æ–≤: 50 (—Å–µ—Ä–≤–∏—Å—ã + —Ç–∞–±–ª–∏—Ü—ã)
  ‚îú‚îÄ –†—ë–±–µ—Ä: 97
  ‚îî‚îÄ –¢–∏–ø: –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ (DAG)

–ü—É—Ç–∏:
  ‚îú‚îÄ –í—Å–µ–≥–æ –ø—É—Ç–µ–π: 228
  ‚îú‚îÄ –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞: 3-5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  ‚îî‚îÄ –î–∏–∞–ø–∞–∑–æ–Ω: 2-10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤

–û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
  ‚îú‚îÄ –í—Å–µ–≥–æ –ø—Ä–∏–º–µ—Ä–æ–≤: 107
  ‚îú‚îÄ Train: 74 (70%)
  ‚îú‚îÄ Test: 33 (30%)
  ‚îú‚îÄ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤: 4
  ‚îî‚îÄ –ü—Ä–∏–º–µ—Ä–æ–≤ –Ω–∞ –∫–ª–∞—Å—Å: ~27
```

---

## üöÄ –ó–∞–ø—É—Å–∫

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
cd "sequence recomendation"

# üèÜ –° –†–ï–ê–õ–¨–ù–´–ú–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò (–≤–µ—Ä—Å–∏—è 4.1) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø! ‚≠ê‚≠ê‚≠ê
python3 sequence_dag_recommender_with_real_users.py

# –ò–õ–ò —Å –≥—Ä–∞—Ñ–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –±–µ–∑ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤–µ—Ä—Å–∏—è 3.1)
python3 sequence_dag_recommender_with_graph_features.py

# –ò–õ–ò –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è (–≤–µ—Ä—Å–∏—è 3.0)
python3 sequence_dag_recommender_final.py
```

### üèÜ –° –†–ï–ê–õ–¨–ù–´–ú–ò –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–≤–µ—Ä—Å–∏—è 4.1) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø! ‚≠ê‚≠ê‚≠ê

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç owner –∏–∑ –¥–∞–Ω–Ω—ã—Ö
python3 sequence_dag_recommender_with_real_users.py

# –° –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
python3 sequence_dag_recommender_with_real_users.py \
  --data compositionsDAG.json \
  --epochs 100 \
  --hidden-channels 64 \
  --learning-rate 0.001

# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
python3 sequence_dag_recommender_with_real_users.py --epochs 50
```

### üìä –° –≥—Ä–∞—Ñ–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ (–≤–µ—Ä—Å–∏—è 3.1)

```bash
# –° –≥—Ä–∞—Ñ–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ (PageRank, —Å—Ç–µ–ø–µ–Ω–∏ —É–∑–ª–æ–≤, centrality)
python3 sequence_dag_recommender_with_graph_features.py --data compositionsDAG.json

# –ë–µ–∑ –≥—Ä–∞—Ñ–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)
python3 sequence_dag_recommender_with_graph_features.py --data compositionsDAG.json --no-graph-features
```

### –° –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)

```bash
# –õ—É—á—à–∏–π seed –¥–ª—è DAGNN (–±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
python3 sequence_dag_recommender_final.py --random-seed 456

# DAGNN —Å –≥—Ä–∞—Ñ–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ (–≤–µ—Ä—Å–∏—è 3.1)
python3 sequence_dag_recommender_with_graph_features.py --random-seed 456
```

### –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```bash
python3 sequence_dag_recommender_final.py \
  --data compositionsDAG.json \      # –ü—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
  --random-seed 456 \                # Random seed
  --epochs 200 \                     # –ú–∞–∫—Å–∏–º—É–º —ç–ø–æ—Ö (—Å early stopping)
  --hidden-channels 64 \             # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤
  --learning-rate 0.001 \            # Learning rate
  --dropout 0.4 \                    # Dropout rate
  --test-size 0.3                    # –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------------|----------|
| `--data` | `compositionsDAG.json` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–∞–Ω–Ω—ã—Ö |
| `--random-seed` | `42` | Random seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ |
| `--epochs` | `200` | –ú–∞–∫—Å–∏–º—É–º —ç–ø–æ—Ö (—Å early stopping) |
| `--hidden-channels` | `64` | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤ –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π |
| `--learning-rate` | `0.001` | Learning rate –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ |
| `--dropout` | `0.4` | Dropout rate –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ |
| `--test-size` | `0.3` | –î–æ–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ (0.0-1.0) |
| `--no-graph-features` | `False` | üÜï –û—Ç–∫–ª—é—á–∏—Ç—å –≥—Ä–∞—Ñ–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è version 3.1) |

### –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

![–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è](images/training_speed.png)

*–†–∏—Å—É–Ω–æ–∫ 5: –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π. Caser - —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è (420 it/s).*

---

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π

![–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö seeds](images/seed_stability.png)

*–†–∏—Å—É–Ω–æ–∫ 6: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ random seed. DAGNN –∏ SASRec –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.*

---

### –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –º–µ—Ç—Ä–∏–∫

![Heatmap –º–µ—Ç—Ä–∏–∫](images/metrics_heatmap.png)

*–†–∏—Å—É–Ω–æ–∫ 7: –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π. –ó–µ–ª–µ–Ω—ã–π = –ª—É—á—à–µ, –∫—Ä–∞—Å–Ω—ã–π = —Ö—É–∂–µ.*

---

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

![Pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö](images/data_pipeline.png)

*–†–∏—Å—É–Ω–æ–∫ 8: –°—Ö–µ–º–∞ pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ JSON –¥–æ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞.*

```
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (compositionsDAG.json)
   ‚Üì
2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ DAG –≥—Ä–∞—Ñ–∞ (50 —É–∑–ª–æ–≤, 97 —Ä—ë–±–µ—Ä)
   ‚Üì
3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—É—Ç–µ–π (228 –ø—É—Ç–µ–π)
   ‚Üì
4. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ (107 –ø—Ä–∏–º–µ—Ä–æ–≤)
   ‚Üì
5. –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ split –Ω–∞ train/test (74/33)
   ‚Üì
6. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π (8 –º–æ–¥–µ–ª–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ):
   ‚îú‚îÄ Random Forest
   ‚îú‚îÄ Popularity
   ‚îú‚îÄ GCN
   ‚îú‚îÄ DAGNN
   ‚îú‚îÄ GraphSAGE
   ‚îú‚îÄ GRU4Rec
   ‚îú‚îÄ SASRec
   ‚îî‚îÄ Caser
   ‚Üì
7. –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
   ‚Üì
8. –í—ã–≤–æ–¥ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞
```

### –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
–û–±—â–µ–µ –≤—Ä–µ–º—è: ~2-3 –º–∏–Ω—É—Ç—ã

–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è:
‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö:        < 1 —Å–µ–∫
‚îú‚îÄ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:             < 1 —Å–µ–∫
‚îú‚îÄ Random Forest:          ~5 —Å–µ–∫
‚îú‚îÄ GNN –º–æ–¥–µ–ª–∏ (3):         ~3-4 —Å–µ–∫
‚îú‚îÄ Sequential –º–æ–¥–µ–ª–∏ (3):  ~8-10 —Å–µ–∫
‚îî‚îÄ –û—Ü–µ–Ω–∫–∞ –∏ –≤—ã–≤–æ–¥:         < 1 —Å–µ–∫
```

---

## ü§ñ –ú–æ–¥–µ–ª–∏

–°–∏—Å—Ç–µ–º–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç **8 –º–æ–¥–µ–ª–µ–π** –∏–∑ 6 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–æ–¥–µ–ª–µ–π:

```
üß† Graph Neural Networks (3 –º–æ–¥–µ–ª–∏)
   ‚îú‚îÄ DAGNN      - –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è DAG
   ‚îú‚îÄ GraphSAGE  - –ë—ã—Å—Ç—Ä–∞—è, inductive learning
   ‚îî‚îÄ GCN        - –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è GNN

üéØ Attention-based (1 –º–æ–¥–µ–ª—å)
   ‚îî‚îÄ SASRec     - Self-attention –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

üß± CNN-based (1 –º–æ–¥–µ–ª—å)
   ‚îî‚îÄ Caser      - Horizontal + Vertical convolutions

üîÑ RNN-based (1 –º–æ–¥–µ–ª—å)
   ‚îî‚îÄ GRU4Rec    - Gated Recurrent Unit

üìä ML-based (1 –º–æ–¥–µ–ª—å)
   ‚îî‚îÄ Random Forest - –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML

üìà Simple (1 –º–æ–¥–µ–ª—å)
   ‚îî‚îÄ Popularity - –ß–∞—Å—Ç–æ—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

![–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –ø–æ Accuracy](images/accuracy_comparison.png)

*–†–∏—Å—É–Ω–æ–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö 8 –º–æ–¥–µ–ª–µ–π –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ (Accuracy). DAGNN - —è–≤–Ω—ã–π –ª–∏–¥–µ—Ä —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º 0.5152.*

---

### –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (seed=456, epochs=150)

| –ú–µ—Å—Ç–æ | –ú–æ–¥–µ–ª—å | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | Accuracy | F1 | Precision | Recall | nDCG | –°–∫–æ—Ä–æ—Å—Ç—å |
|-------|--------|-----------|----------|-----|-----------|--------|------|----------|
| ü•á **#1** | **DAGNN** | GNN | **0.5152** | **0.3824** | **0.3400** | 0.5000 | **0.7893** | 257 it/s |
| ü•à **#2** | **SASRec** ‚ú® | Attention | **0.4848** | 0.3712 | 0.3300 | 0.5000 | 0.7742 | 350 it/s |
| ü•à **#2** | **Caser** ‚ú® | CNN | **0.4848** | 0.3712 | 0.3300 | 0.5000 | **0.7781** | **420 it/s** |
| **#2** | GraphSAGE | GNN | 0.4848 | 0.3712 | 0.3300 | 0.5000 | 0.7742 | 415 it/s |
| **#2** | GCN | GNN | 0.4848 | 0.3712 | 0.3300 | 0.5000 | 0.7781 | 275 it/s |
| **#2** | Random Forest | ML | 0.4848 | 0.3712 | 0.3300 | 0.5000 | 0.7742 | - |
| **#7** | GRU4Rec | RNN | 0.2727 | 0.1071 | 0.0682 | 0.2500 | 0.6513 | 215 it/s |
| **#8** | Popularity | Baseline | 0.2727 | 0.1071 | 0.0682 | 0.2500 | 0.6513 | - |

**–ö–ª—é—á–µ–≤—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:**

1. ‚úÖ **DAGNN - —è–≤–Ω—ã–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å** (accuracy 0.5152, nDCG 0.7893)
2. ‚úÖ **5 –º–æ–¥–µ–ª–µ–π –ø–æ–∫–∞–∑–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π accuracy** (0.4848) - –∏–∑-–∑–∞ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
3. ‚úÖ **SASRec –∏ Caser** —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–ª—è sequential –º–æ–¥–µ–ª–µ–π
4. ‚ö†Ô∏è **GRU4Rec** —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (107 –ø—Ä–∏–º–µ—Ä–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ random seeds

| Seed | –ü–æ–±–µ–¥–∏—Ç–µ–ª—å | Accuracy | nDCG | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|-----------|----------|------|-------------|
| **456** | **DAGNN** ü•á | **0.5152** | **0.7893** | –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
| 42 | GraphSAGE | 0.5152 | 0.7893 | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å |
| 789 | DAGNN | 0.5152 | 0.7893 | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ |
| 123 | Random Forest | 0.4848 | 0.7742 | - |

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–±–µ–¥:**
- DAGNN: 50% (2/4 seeds) ü•áü•á ‚Üê –°–ê–ú–ê–Ø –°–¢–ê–ë–ò–õ–¨–ù–ê–Ø
- GraphSAGE: 25% (1/4 seeds) ü•á
- Random Forest: 25% (1/4 seeds) ü•á

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

**Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å):**
- DAGNN: **0.5152** (51.52% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π) ü•á
- SASRec, Caser, GraphSAGE: 0.4848 (48.48%)
- GRU4Rec: 0.2727 (27.27%)

**nDCG (–∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è):**
- DAGNN: **0.7893** ü•á
- Caser: 0.7781 (–ª—É—á—à–∞—è —Å—Ä–µ–¥–∏ sequential!)
- GCN: 0.7781
- SASRec, GraphSAGE: 0.7742

**F1-score (–±–∞–ª–∞–Ω—Å precision/recall):**
- DAGNN: **0.3824** ü•á
- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–ø-–º–æ–¥–µ–ª–∏: 0.3712

---

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è Accuracy vs nDCG

![Accuracy vs nDCG](images/accuracy_vs_ndcg.png)

*–†–∏—Å—É–Ω–æ–∫ 2: Scatter plot Accuracy vs nDCG. –†–∞–∑–º–µ—Ä —Ç–æ—á–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è. DAGNN –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É - –ª—É—á—à–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫.*

---

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ–ø-4 –º–æ–¥–µ–ª–µ–π

![Radar Chart](images/radar_chart.png)

*–†–∏—Å—É–Ω–æ–∫ 3: Radar chart —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–æ–ø-4 –º–æ–¥–µ–ª–µ–π –ø–æ 5 –º–µ—Ç—Ä–∏–∫–∞–º (Accuracy, nDCG, F1-score, Speed, Stability). DAGNN –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å.*

---

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

![–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º](images/category_comparison.png)

*–†–∏—Å—É–Ω–æ–∫ 4: –°—Ä–µ–¥–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –º–æ–¥–µ–ª–µ–π. GNN –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.*

---

## üíª –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```
Python >= 3.8
PyTorch >= 2.0.0
PyTorch Geometric >= 2.3.0
NetworkX >= 3.0
scikit-learn >= 1.3.0
NumPy >= 1.24.0
tqdm >= 4.65.0
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ë–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install torch torch-geometric networkx scikit-learn numpy tqdm

# –ò–ª–∏ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
pip install -r ../requirements.txt
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
python3 -c "import torch; import torch_geometric; print('‚úÖ OK')"
```

---

## üèÉ –ó–∞–ø—É—Å–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### 1. –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (–≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```bash
cd "sequence recomendation"
python3 sequence_dag_recommender_final.py
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è `compositionsDAG.json`
- –û–±—É—á–∞—é—Ç—Å—è –≤—Å–µ 8 –º–æ–¥–µ–ª–µ–π (200 —ç–ø–æ—Ö —Å early stopping)
- –í—ã–≤–æ–¥—è—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2-3 –º–∏–Ω—É—Ç—ã

**–í—ã–≤–æ–¥:**
```
2025-10-13 XX:XX:XX - INFO - Loading DAG from compositionsDAG.json
2025-10-13 XX:XX:XX - INFO - Loaded DAG with 50 nodes and 97 edges
...
üìä Random Forest Metrics
Accuracy:  0.4848
...
üèÜ –ò–¢–û–ì–û–í–û–ï –°–†–ê–í–ù–ï–ù–ò–ï
#1 DAGNN: accuracy: 0.5152
#2 SASRec: accuracy: 0.4848
...
```

---

### 2. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ seed=456 –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ DAGNN
python3 sequence_dag_recommender_final.py --random-seed 456 --epochs 200
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- DAGNN: **accuracy 0.5152, nDCG 0.7893** ü•á
- SASRec: accuracy 0.4848
- Caser: accuracy 0.4848

---

### 3. –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (–º–µ–Ω—å—à–µ —ç–ø–æ—Ö)

```bash
# –î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ (50 —ç–ø–æ—Ö)
python3 sequence_dag_recommender_final.py --epochs 50
```

**–í—Ä–µ–º—è:** ~30-40 —Å–µ–∫—É–Ω–¥

---

### 4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö seeds

```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π
for seed in 42 123 456 789; do
    echo "=== Seed: $seed ==="
    python3 sequence_dag_recommender_final.py --random-seed $seed --epochs 100
done
```

**–ó–∞—á–µ–º:**
- –û—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π
- –ù–∞–π—Ç–∏ –ª—É—á—à–∏–π seed
- –ü–æ–Ω—è—Ç—å –≤–ª–∏—è–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏

---

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```bash
# –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
python3 sequence_dag_recommender_final.py \
  --random-seed 456 \
  --epochs 300 \
  --hidden-channels 128 \
  --learning-rate 0.0005 \
  --dropout 0.3
```

---

### 6. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
python3 visualize_results_v2.py
```

**–í—ã–≤–æ–¥:**
- –¢–∞–±–ª–∏—Ü—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
- –ì—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑ —É–ª—É—á—à–µ–Ω–∏–π
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π

### 1. üèÜ DAGNN (Directed Acyclic Graph NN) - –õ–£–ß–®–ê–Ø!

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** DAG —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: Node features (50 nodes √ó 2 features)
       [1,0] –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
       [0,1] –¥–ª—è —Ç–∞–±–ª–∏—Ü
  ‚Üì
Linear(2 ‚Üí 64) + BatchNorm + ReLU + Dropout(0.4)
  ‚Üì
Linear(64 ‚Üí 64) + BatchNorm + ReLU + [Residual] + Dropout(0.4)
  ‚Üì
DAGNN Propagation Layer:
  ‚îú‚îÄ APPNP(K=10, alpha=0.1)
  ‚îú‚îÄ Attention weights (learnable)
  ‚îú‚îÄ –ê–≥—Ä–µ–≥–∞—Ü–∏—è K+1 —Å–ª–æ–µ–≤: [x‚ÇÄ, x‚ÇÅ, ..., x‚Çñ]
  ‚îî‚îÄ Weighted sum: Œ£(Œ±·µ¢ ¬∑ x·µ¢)
  ‚Üì
Linear(64 ‚Üí 32) + BatchNorm + ReLU + Dropout(0.4)
  ‚Üì
Linear(32 ‚Üí 50) [num_classes]
  ‚Üì
Output: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **APPNP (Approximate Personalized Propagation)**: K-hop —Å–æ—Å–µ–¥–∏ —Å –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º
- **Attention weights**: –æ–±—É—á–∞–µ–º—ã–µ –≤–µ—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ hop
- **Alpha=0.1**: –æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å–≤—è–∑—å —Å –∏—Å—Ö–æ–¥–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º
- **Residual connections**: —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
Total params: ~6,000
‚îú‚îÄ Embedding layers: ~2,500
‚îú‚îÄ DAGNN layer: ~2,000
‚îî‚îÄ FC layers: ~1,500
```

**–ü–æ—á–µ–º—É –ª—É—á—à–∞—è:**
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –≥—Ä–∞—Ñ–æ–≤
- ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É DAG —á–µ—Ä–µ–∑ APPNP
- ‚úÖ Attention –¥–ª—è –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö hop'–æ–≤
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö seeds

---

### 2. üéØ SASRec (Self-Attentive Sequential) - –ù–û–í–û–ï! ‚ú®

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** Sequential —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å self-attention

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å [s‚ÇÅ, s‚ÇÇ, ..., s‚Çô] (batch_size √ó seq_len)
  ‚Üì
Item Embedding(num_items+1, 64) + Positional Encoding(max_len, 64)
  ‚Üì
Self-Attention Block 1:
  ‚îú‚îÄ Multi-Head Self-Attention (2 heads)
  ‚îÇ   Q = W_Q ¬∑ X
  ‚îÇ   K = W_K ¬∑ X  
  ‚îÇ   V = W_V ¬∑ X
  ‚îÇ   Attention(Q,K,V) = softmax(QK^T/‚àöd_k)V
  ‚îú‚îÄ Point-wise Feed-Forward (64 ‚Üí 256 ‚Üí 64)
  ‚îú‚îÄ Residual connection: x = x + Attention(x)
  ‚îî‚îÄ LayerNorm(x) [Pre-LN –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏]
  ‚Üì
Self-Attention Block 2:
  ‚îú‚îÄ Multi-Head Self-Attention
  ‚îú‚îÄ Feed-Forward
  ‚îî‚îÄ Residual + LayerNorm
  ‚Üì
Take last position: x[:, -1, :]  (–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è)
  ‚Üì
LayerNorm(64)
  ‚Üì
Linear(64 ‚Üí 50) [num_classes]
  ‚Üì
Output: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **Self-attention**: –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ
- **Positional encoding**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Multi-head (2 heads)**: —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –≤–Ω–∏–º–∞–Ω–∏—è
- **Pre-LN (norm_first=True)**: –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥ attention
- **Causal mask**: —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –≤–∏–¥–∏—Ç –±—É–¥—É—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
Total params: ~15,000
‚îú‚îÄ Embeddings: ~6,500
‚îú‚îÄ Attention blocks: ~7,000
‚îî‚îÄ FC layer: ~1,500
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–±—ã—Å—Ç—Ä–µ–µ RNN)
- ‚úÖ Long-range dependencies
- ‚úÖ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–µ attention weights
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–∞–∂–µ –Ω–∞ –º–∞–ª—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848, nDCG 0.7742

---

### 3. üß± Caser (Convolutional Sequence Embedding) - –ù–û–í–û–ï! ‚ú®

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** CNN –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å [s‚ÇÅ, s‚ÇÇ, ..., s‚Çô] ‚Üí –±–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ L=5
  ‚Üì
Item Embedding(num_items+1, 64) ‚Üí Matrix (batch_size, 5, 64)
  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ HORIZONTAL CONVOLUTIONS     ‚îÇ VERTICAL CONVOLUTION       ‚îÇ
‚îÇ (skip-gram like –ø–∞—Ç—Ç–µ—Ä–Ω—ã)   ‚îÇ (union-level –ø–∞—Ç—Ç–µ—Ä–Ω—ã)     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Conv2d(1, 16, (2, 64))      ‚îÇ Conv2d(1, 4, (5, 1))      ‚îÇ
‚îÇ   ‚Üì ReLU + MaxPool          ‚îÇ   ‚Üì ReLU                   ‚îÇ
‚îÇ   ‚Üí 16 features             ‚îÇ   ‚Üí Flatten                ‚îÇ
‚îÇ                             ‚îÇ   ‚Üí 4√ó64 = 256 features    ‚îÇ
‚îÇ Conv2d(1, 16, (3, 64))      ‚îÇ                            ‚îÇ
‚îÇ   ‚Üì ReLU + MaxPool          ‚îÇ                            ‚îÇ
‚îÇ   ‚Üí 16 features             ‚îÇ                            ‚îÇ
‚îÇ                             ‚îÇ                            ‚îÇ
‚îÇ Conv2d(1, 16, (4, 64))      ‚îÇ                            ‚îÇ
‚îÇ   ‚Üì ReLU + MaxPool          ‚îÇ                            ‚îÇ
‚îÇ   ‚Üí 16 features             ‚îÇ                            ‚îÇ
‚îÇ                             ‚îÇ                            ‚îÇ
‚îÇ Total: 48 features          ‚îÇ Total: 256 features        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚Üì
Concatenate: 48 + 256 = 304 features
  ‚Üì
Dropout(0.4)
  ‚Üì
Linear(304 ‚Üí 128) + BatchNorm + ReLU + Dropout
  ‚Üì
Linear(128 ‚Üí 50) [num_classes]
  ‚Üì
Output: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **Horizontal convolutions**: 
  - –û–∫–Ω–∞ —Ä–∞–∑–º–µ—Ä–æ–º 2, 3, 4 —ç–ª–µ–º–µ–Ω—Ç–∞
  - –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç skip-gram –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–ø–∞—Ä—ã, —Ç—Ä–æ–π–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
  - MaxPooling –¥–ª—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç–∏
  
- **Vertical convolution**:
  - –†–∞–∑–º–µ—Ä (L√ó1) - –ø–æ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç embedding'–∏ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  - Union-level representation

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
Total params: ~45,000
‚îú‚îÄ Embeddings: ~3,200
‚îú‚îÄ Conv filters: ~35,000
‚îî‚îÄ FC layers: ~6,800
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- ‚úÖ –ú–µ–Ω—å—à–µ —Å–∫–ª–æ–Ω–Ω–∞ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ–±—É—á–µ–Ω–∏–µ (420 it/s - –°–ê–ú–ê–Ø –ë–´–°–¢–†–ê–Ø!)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω–µ L=5

**–¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848, nDCG 0.7781 (–æ—Ç–ª–∏—á–Ω—ã–π!)

---

### 4. ‚ö° GraphSAGE

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** Inductive learning –Ω–∞ –≥—Ä–∞—Ñ–∞—Ö

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: Graph (x=node features, edge_index=edges)
  ‚Üì
SAGEConv(2 ‚Üí 64, aggr='mean')
  ‚îú‚îÄ –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–æ—Å–µ–¥–µ–π: mean pooling
  ‚îú‚îÄ Concat(x, aggregated_neighbors)
  ‚îî‚îÄ Linear transformation
  ‚Üì LayerNorm + ReLU + Dropout(0.4)
  ‚Üì
SAGEConv(64 ‚Üí 128, aggr='max')
  ‚îú‚îÄ –ê–≥—Ä–µ–≥–∞—Ü–∏—è: max pooling (–¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è)
  ‚îî‚îÄ Linear transformation
  ‚Üì LayerNorm + ReLU + Dropout
  ‚Üì
SAGEConv(128 ‚Üí 64, aggr='mean')
  ‚Üì LayerNorm + ReLU + Dropout
  ‚Üì
Linear(64 ‚Üí 32) + LayerNorm + ReLU + Dropout(0.2)
  ‚Üì
Linear(32 ‚Üí 50)
  ‚Üì
Output: Embeddings –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **SAGE aggregation**: mean/max pooling —Å–æ—Å–µ–¥–µ–π
- **Inductive**: –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–æ–≤—ã–º–∏ —É–∑–ª–∞–º–∏
- **–†–∞–∑–Ω—ã–µ aggregators**: mean –∏ max –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è GNN (415 it/s)
- ‚úÖ Inductive learning
- ‚úÖ –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–∞–ª—ã—Ö –≥—Ä–∞—Ñ–∞—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848

---

### 5. üß† GCN (Graph Convolutional Network)

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è GNN

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: Graph (x, edge_index)
  ‚Üì
GCNConv(2 ‚Üí 64)
  ‚îî‚îÄ Spectral convolution: H = DÃÉ^(-1/2) √É DÃÉ^(-1/2) X W
  ‚Üì LayerNorm + ELU + Dropout(0.5)
  ‚Üì
GCNConv(64 ‚Üí 128) 
  ‚Üì LayerNorm + ELU + Dropout
  ‚Üì
GCNConv(128 ‚Üí 64)
  ‚Üì LayerNorm + ELU + Dropout
  ‚Üì
Linear(64 ‚Üí 32) + LayerNorm + ELU + Dropout
  ‚Üì
Linear(32 ‚Üí 50)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848, nDCG 0.7781

---

### 6. üîÑ GRU4Rec (Gated Recurrent Unit)

**–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** RNN –¥–ª—è session-based —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å [s‚ÇÅ, s‚ÇÇ, ..., s‚Çô]
  ‚Üì
Embedding(num_items+1, 64) + Dropout(0.4)
  ‚Üì
Multi-layer GRU (2 —Å–ª–æ—è, hidden_size=128):
  Layer 1: GRU(64 ‚Üí 128)
    ‚îú‚îÄ Update gate: z‚Çú = œÉ(Wz¬∑[h‚Çú‚Çã‚ÇÅ, x‚Çú])
    ‚îú‚îÄ Reset gate:  r‚Çú = œÉ(Wr¬∑[h‚Çú‚Çã‚ÇÅ, x‚Çú])
    ‚îî‚îÄ New state:   h‚Çú = (1-z‚Çú)‚äôh‚Çú‚Çã‚ÇÅ + z‚Çú‚äôtanh(W¬∑[r‚Çú‚äôh‚Çú‚Çã‚ÇÅ, x‚Çú])
  ‚Üì
  Layer 2: GRU(128 ‚Üí 128)
  ‚Üì
Take last hidden state: h_last
  ‚Üì
BatchNorm(128) + ReLU + Dropout
  ‚Üì
Linear(128 ‚Üí 64) + BatchNorm + ReLU + Dropout
  ‚Üì
Linear(64 ‚Üí 50)
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **Gated mechanism**: update –∏ reset gates
- **Sequential processing**: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ –ø–æ—Ä—è–¥–∫—É
- **Variable length**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

**–ü–æ—á–µ–º—É –Ω–∏–∑–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (0.2727):**
- RNN —Ç—Ä–µ–±—É–µ—Ç **–º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö** (5000+)
- –¢–µ–∫—É—â–µ–µ: 107 –ø—Ä–∏–º–µ—Ä–æ–≤ ‚Üí –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
- –ö–æ—Ä–æ—Ç–∫–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (1-3 —ç–ª–µ–º–µ–Ω—Ç–∞)

**–ü—Ä–∏ 5000+ –ø—Ä–∏–º–µ—Ä–∞—Ö:** accuracy 65-75%

---

### 7. üìä Random Forest

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Input: –ë–∏–Ω–∞—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å=27)
  ‚Üì
Ensemble –∏–∑ 200 –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π:
  Tree 1: max_depth=15, bootstrap sample
  Tree 2: max_depth=15, bootstrap sample
  ...
  Tree 200: max_depth=15, bootstrap sample
  ‚Üì
Voting: –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ
  ‚Üì
Output: –ö–ª–∞—Å—Å + –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≥—Ä–∞—Ñ–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (feature importance)
- ‚úÖ –†–æ–±–∞—Å—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848

---

### 8. üìà Popularity Baseline

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Training:
  Count(class) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
  ‚Üì
  top_class = argmax(Count)

Prediction:
  –í—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç top_class
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.2424 (baseline –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è)

---

## üîç –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π accuracy?

**–ü—Ä–∏—á–∏–Ω–∞:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç (33 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–∞, 4 –∫–ª–∞—Å—Å–∞)

–ü—Ä–∏ 33 –ø—Ä–∏–º–µ—Ä–∞—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π accuracy –º–∞–ª–æ:
- 17/33 = **0.5152** ‚Üê DAGNN –∑–¥–µ—Å—å
- 16/33 = **0.4848** ‚Üê 5 –º–æ–¥–µ–ª–µ–π –∑–¥–µ—Å—å!
- 15/33 = **0.4545**
- 9/33 = **0.2727** ‚Üê GRU4Rec –∏ Popularity

**–ù–û –º–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç –†–ê–ó–ù–´–ï –∫–ª–∞—Å—Å—ã!**

–ò–∑ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤:
```
GCN:       –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å—ã [0, 2]  ‚Üí accuracy: 0.4848
DAGNN:     –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å—ã [1, 2]  ‚Üí accuracy: 0.4848
SASRec:    –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å—ã [2, 6]  ‚Üí accuracy: 0.4848
```

**–í—ã–≤–æ–¥:** –ú–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ü–û-–†–ê–ó–ù–û–ú–£, –Ω–æ —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ª—É—á–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π accuracy –∏–∑-–∑–∞ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞!

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–¥—Ä–æ–±–Ω–æ

**Accuracy (–¢–æ—á–Ω–æ—Å—Ç—å):**
```
Accuracy = –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è / –í—Å–µ–≥–æ –ø—Ä–∏–º–µ—Ä–æ–≤
0.5152 = 17/33 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
```

**F1-score:**
```
F1 = 2 √ó (Precision √ó Recall) / (Precision + Recall)
Macro-averaging: —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º
```

**nDCG (Normalized Discounted Cumulative Gain):**
```
–ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è top-k —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
0.7893 = —Ö–æ—Ä–æ—à–µ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
1.0 = –∏–¥–µ–∞–ª—å–Ω–æ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
```

**–°–∫–æ—Ä–æ—Å—Ç—å (iterations/sec):**
```
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –æ–±—É—á–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥—É
–í—ã—à–µ = –±—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–µ–Ω–∏–µ
```

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–æ –º–æ–¥–µ–ª—è–º

**DAGNN (0.5152):**
- ‚úÖ 17 –∏–∑ 33 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- ‚úÖ –õ—É—á—à–µ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (nDCG 0.7893)
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è DAG ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É

**SASRec (0.4848):**
- ‚úÖ 16 –∏–∑ 33 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
- ‚úÖ Attention —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–ª—è attention –º–æ–¥–µ–ª–∏

**Caser (0.4848):**
- ‚úÖ 16 –∏–∑ 33 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
- ‚úÖ –õ—É—á—à–∏–π nDCG —Å—Ä–µ–¥–∏ sequential –º–æ–¥–µ–ª–µ–π (0.7781)
- ‚úÖ CNN —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**GRU4Rec (0.2727):**
- ‚ö†Ô∏è –¢–æ–ª—å–∫–æ 9 –∏–∑ 33 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
- ‚ö†Ô∏è RNN —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è embeddings
- üöÄ –ü—Ä–∏ 5000+ –ø—Ä–∏–º–µ—Ä–∞—Ö –º–æ–∂–µ—Ç –ø—Ä–µ–≤–∑–æ–π—Ç–∏ –≤—Å–µ –º–æ–¥–µ–ª–∏

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (—Ç–µ–∫—É—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç)

#### 1Ô∏è‚É£ DAGNN - –ì–õ–ê–í–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø üèÜ

```bash
python3 sequence_dag_recommender_final.py --random-seed 456
```

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ DAGNN –∫–æ–≥–¥–∞:**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç DAG —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- ‚úÖ –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
- ‚úÖ –ï—Å—Ç—å –≥—Ä–∞—Ñ–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.5152, nDCG 0.7893

---

#### 2Ô∏è‚É£ SASRec - –¥–ª—è sequential —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π üéØ

```bash
python3 sequence_dag_recommender_final.py --random-seed 456
```

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SASRec –∫–æ–≥–¥–∞:**
- ‚úÖ –í–∞–∂–µ–Ω –ø–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (attention weights)
- ‚úÖ –°—Ä–µ–¥–Ω–∏–µ/–¥–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (5-20)
- ‚úÖ –ù–µ—Ç –≥—Ä–∞—Ñ–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848, –±—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ

---

#### 3Ô∏è‚É£ Caser - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ üß±

```bash
python3 sequence_dag_recommender_final.py --random-seed 456
```

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Caser –∫–æ–≥–¥–∞:**
- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (3-10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- ‚úÖ –í–∞–∂–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (bigrams, trigrams)
- ‚úÖ –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (420 it/s!)
- ‚úÖ –ú–∞–ª—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848, nDCG 0.7781, –°–ê–ú–ê–Ø –ë–´–°–¢–†–ê–Ø!

---

#### 4Ô∏è‚É£ GraphSAGE - –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ ‚ö°

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GraphSAGE –∫–æ–≥–¥–∞:**
- ‚úÖ –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å GNN
- ‚úÖ Inductive learning (–Ω–æ–≤—ã–µ —É–∑–ª—ã)
- ‚úÖ –ú–∞–ª—ã–µ –≥—Ä–∞—Ñ—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Accuracy 0.4848, 415 it/s

---

### –ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–æ 5000+

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:**

1. **SASRec** –∏–ª–∏ **GRU4Rec** (–æ–∂–∏–¥–∞–µ–º–æ 70-75%)
   - Sequential –º–æ–¥–µ–ª–∏ —Ä–∞—Å–∫—Ä–æ—é—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª
   - Embeddings –æ–±—É—á–∞—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ

2. **DAGNN** (–æ–∂–∏–¥–∞–µ–º–æ 65-70%)
   - –û—Å—Ç–∞–Ω–µ—Ç—Å—è —Å–∏–ª—å–Ω–æ–π –¥–ª—è DAG —Å—Ç—Ä—É–∫—Ç—É—Ä

3. **Caser** (–æ–∂–∏–¥–∞–µ–º–æ 60-70%)
   - –°—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

### –î–ª—è ensemble –ø–æ–¥—Ö–æ–¥–∞

```python
# –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏
final_prediction = (
    0.4 * dagnn_pred +      # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å - –±–æ–ª—å—à–∏–π –≤–µ—Å
    0.3 * sasrec_pred +     # Attention –ø–æ–¥—Ö–æ–¥
    0.2 * caser_pred +      # CNN –ø–æ–¥—Ö–æ–¥
    0.1 * graphsage_pred    # GNN –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞
)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ensemble:**
- ‚úÖ –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –ú–µ–Ω—å—à–µ –≤–ª–∏—è–Ω–∏–µ random seed
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã (GNN + Attention + CNN)

---

## üìà –°–ø–æ—Å–æ–±—ã —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 1. –ö–†–ò–¢–ò–ß–ù–û: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞

**–¢–µ–∫—É—â–µ–µ:**
```
107 –ø—Ä–∏–º–µ—Ä–æ–≤ ‚Üí –≤—ã—Å–æ–∫–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
33 —Ç–µ—Å—Ç–æ–≤—ã—Ö ‚Üí —Å–ª—É—á–∞–π–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è accuracy
4 –∫–ª–∞—Å—Å–∞ ‚Üí –ø—Ä–æ—Å—Ç–∞—è –∑–∞–¥–∞—á–∞
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
```
1000+ –ø—Ä–∏–º–µ—Ä–æ–≤ ‚Üí —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
10-20 –ø—Ä–∏–º–µ—Ä–æ–≤ –Ω–∞ –∫–ª–∞—Å—Å
–ë–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ –ø—É—Ç—è—Ö
```

**–ö–∞–∫ —É–≤–µ–ª–∏—á–∏—Ç—å:**

```python
# Data Augmentation - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥–ø—É—Ç–µ–π
augmented_paths = []
for path in original_paths:
    for i in range(2, len(path)):
        sub_path = path[:i]
        augmented_paths.append(sub_path)

# Sliding window
for path in paths:
    for i in range(len(path) - window_size):
        window = path[i:i+window_size+1]
        augmented_paths.append(window)
```

---

### 2. Hyperparameter Tuning

```bash
# Grid search –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
for hidden in 32 64 128; do
  for dropout in 0.3 0.4 0.5; do
    for lr in 0.0005 0.001 0.002; do
      python3 sequence_dag_recommender_final.py \
        --hidden-channels $hidden \
        --dropout $dropout \
        --learning-rate $lr \
        --random-seed 456
    done
  done
done
```

---

### 3. Feature Engineering –¥–ª—è —É–∑–ª–æ–≤

```python
# –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:
node_features = [
    in_degree,           # –í—Ö–æ–¥—è—â–∞—è —Å—Ç–µ–ø–µ–Ω—å
    out_degree,          # –ò—Å—Ö–æ–¥—è—â–∞—è —Å—Ç–µ–ø–µ–Ω—å
    betweenness,         # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø–æ—Å—Ä–µ–¥–Ω–∏—á–µ—Å—Ç–≤—É
    closeness,           # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –±–ª–∏–∑–æ—Å—Ç–∏
    pagerank,            # PageRank score
    community_id,        # ID —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (Louvain)
]

# –ò–ª–∏ embeddings:
from node2vec import Node2Vec
node2vec_embeddings = Node2Vec(graph).fit()
```

---

### 4. –£–ª—É—á—à–µ–Ω–∏–µ sequential –º–æ–¥–µ–ª–µ–π

**–î–ª—è SASRec:**
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ attention –±–ª–æ–∫–æ–≤
--hidden-channels 128 \
--learning-rate 0.0005
# –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ heads (–ø—Ä–∏ –±–æ–ª—å—à–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ)
```

**–î–ª—è Caser:**
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤
# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –æ–∫–æ–Ω [2,3,4,5]
```

**–î–ª—è GRU4Rec:**
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
--hidden-channels 256 \
--learning-rate 0.0005 \
--dropout 0.3
```

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "torch_geometric not installed"

```bash
# PyTorch Geometric —Ç—Ä–µ–±—É–µ—Ç PyTorch
pip install torch
pip install torch-geometric

# –ò–ª–∏ —Å conda
conda install pyg -c pyg
```

### –û—à–∏–±–∫–∞: "File not found: compositionsDAG.json"

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls compositionsDAG.json

# –ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
python3 sequence_dag_recommender_final.py \
  --data /full/path/to/compositionsDAG.json
```

### –ú–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** –ü—Ä–∏—á–∏–Ω—ã:

1. **–ú–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç** (33 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–∞)
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö accuracy
   - –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–µ–∏–∑–±–µ–∂–Ω—ã

2. **–ú–æ–¥–µ–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –∫–ª–∞—Å—Å—ã**
   - –°–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏: `Prediction distribution`
   - –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –≤—ã–±–∏—Ä–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

3. **Random seed –≤–ª–∏—è–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏**
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ seeds: 42, 123, 456, 789
   - –†–∞–∑–Ω–∏—Ü–∞ –¥–æ 13% accuracy

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ seeds
python3 sequence_dag_recommender_final.py --random-seed 456

# –ò–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç –¥–æ 1000+
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª) - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **QUICK_START.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **MODELS_TO_ADD.md** - –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–µ–π –∏–∑ awesome list

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```bash
python3 visualize_results_v2.py
```

–ü–æ–∫–∞–∂–µ—Ç:
- –¢–∞–±–ª–∏—Ü—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –ì—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

- **sequence_dag_recommender_final.py** (1128 —Å—Ç—Ä–æ–∫):
  - 8 –º–æ–¥–µ–ª–µ–π
  - –ü–æ–ª–Ω—ã–π pipeline –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
  - Early stopping, LR scheduling
  - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéì –°—Å—ã–ª–∫–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

### –°—Ç–∞—Ç—å–∏ –∏ papers:

1. **SASRec**: Self-Attentive Sequential Recommendation (ICDM'18)
2. **Caser**: Personalized Top-N Sequential Recommendation via Convolutional Sequence Embedding (WSDM'18)
3. **GRU4Rec**: Session-based Recommendations with Recurrent Neural Networks (ICLR'16)
4. **BERT4Rec**: Sequential Recommendation with Bidirectional Encoder Representations from Transformer (CIKM'19)

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

- [Awesome-Sequence-Modeling-for-Recommendation](https://github.com/HqWu-HITCS/Awesome-Sequence-Modeling-for-Recommendation) - –∫–æ–ª–ª–µ–∫—Ü–∏—è –º–æ–¥–µ–ª–µ–π –¥–ª—è sequential —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### Tools:

- [RecBole](https://recbole.io/) - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- [Transformers4Rec](https://github.com/NVIDIA-Merlin/Transformers4Rec) - Transformer –º–æ–¥–µ–ª–∏ –æ—Ç NVIDIA

---

## üìû FAQ

**Q: –ü–æ—á–µ–º—É GRU4Rec –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏–∑–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç?**  
A: RNN —Ç—Ä–µ–±—É–µ—Ç 5000-10000+ –ø—Ä–∏–º–µ—Ä–æ–≤. –¢–µ–∫—É—â–∏–µ 107 –ø—Ä–∏–º–µ—Ä–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–∞–ª–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è embeddings –∏ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –≤–µ—Å–æ–≤.

**Q: –ö–∞–∫–∞—è –º–æ–¥–µ–ª—å —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è?**  
A: **Caser** (420 it/s) –¥–ª—è sequential –º–æ–¥–µ–ª–µ–π, **GraphSAGE** (415 it/s) –¥–ª—è GNN –º–æ–¥–µ–ª–µ–π.

**Q: –ü–æ—á–µ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–µ–Ω—è—é—Ç—Å—è —Å random seed?**  
A: –ú–∞–ª–µ–Ω—å–∫–∏–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä (33 –ø—Ä–∏–º–µ—Ä–∞) ‚Üí –≤—ã—Å–æ–∫–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è. –ò–∑–º–µ–Ω–µ–Ω–∏–µ 1-2 –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π = ¬±3% accuracy.

**Q: –ö–∞–∫—É—é –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ?**  
A: **DAGNN** (accuracy 0.5152) - –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –ò–ª–∏ **GraphSAGE** –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏.

**Q: –ö–∞–∫ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã?**  
A: –ì–ª–∞–≤–Ω–æ–µ - **—É–≤–µ–ª–∏—á–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç** –¥–æ 1000+ –ø—Ä–∏–º–µ—Ä–æ–≤. –¢–∞–∫–∂–µ: data augmentation, hyperparameter tuning, ensemble –º–µ—Ç–æ–¥—ã.

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ SASRec –ª—É—á—à–µ —á–µ–º GRU4Rec?**  
A: –î–ê! SASRec: 0.4848 vs GRU4Rec: 0.2727. Self-attention —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ RNN –Ω–∞ –º–∞–ª—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**Q: –ö–∞–∫–∞—è –º–æ–¥–µ–ª—å –ª—É—á—à–µ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π?**  
A: **SASRec** (self-attention) –∏–ª–∏ **GRU4Rec** (–ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).

---

## ‚ú® –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

### üèÜ –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:
**DAGNN** - Accuracy: 0.5152, nDCG: 0.7893

### ‚ö° –°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è:
**Caser** - 420 it/s (sequential), **GraphSAGE** - 415 it/s (GNN)

### üéØ –õ—É—á—à–∞—è sequential –º–æ–¥–µ–ª—å:
**SASRec** - Accuracy: 0.4848, self-attention —Ä–∞–±–æ—Ç–∞–µ—Ç!

### üìä –õ—É—á—à–∏–π nDCG —Å—Ä–µ–¥–∏ sequential:
**Caser** - nDCG: 0.7781

### üîÑ –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö:
**SASRec** –∏–ª–∏ **GRU4Rec** - –æ–∂–∏–¥–∞–µ–º–æ 70-75%

---

**–í–µ—Ä—Å–∏—è:** 3.0 Final  
**–î–∞—Ç–∞:** October 13, 2025  
**–ú–æ–¥–µ–ª–µ–π:** 8 –∏–∑ 6 –∫–∞—Ç–µ–≥–æ—Ä–∏–π  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```bash
python3 sequence_dag_recommender_final.py --random-seed 456
```

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- [Awesome-Sequence-Modeling-for-Recommendation](https://github.com/HqWu-HITCS/Awesome-Sequence-Modeling-for-Recommendation)
- SASRec (ICDM'18), Caser (WSDM'18), GRU4Rec (ICLR'16)
