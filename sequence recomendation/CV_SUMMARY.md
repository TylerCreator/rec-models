# ‚úÖ –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!

## üì¶ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úèÔ∏è **sequence_dag_recommender_final.py** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏
2. ‚úèÔ∏è **README.md** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ CV

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
3. ‚ú® **CROSS_VALIDATION_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
4. ‚ú® **CV_OUTPUT_EXAMPLE.md** - –ø—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
5. ‚ú® **run_cross_validation.sh** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ CV
6. ‚ú® **run_quick_cv.sh** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
7. ‚ú® **CHANGELOG_CV.md** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
8. ‚ú® **CV_SUMMARY.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ü–æ–ª–Ω–∞—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è (5 —Ñ–æ–ª–¥–æ–≤, 200 —ç–ø–æ—Ö)
./run_cross_validation.sh compositionsDAG.json

# –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (3 —Ñ–æ–ª–¥–∞, 100 —ç–ø–æ—Ö)
./run_quick_cv.sh compositionsDAG.json
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫ Python

```bash
# –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å 5 —Ñ–æ–ª–¥–∞–º–∏
python sequence_dag_recommender_final.py --data compositionsDAG.json --use-cv --cv-folds 5

# –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è —Å 3 —Ñ–æ–ª–¥–∞–º–∏ (–±—ã—Å—Ç—Ä–µ–µ)
python sequence_dag_recommender_final.py --data compositionsDAG.json --use-cv --cv-folds 3

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ CV)
python sequence_dag_recommender_final.py --data compositionsDAG.json
```

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –í—Å–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é

| # | –ú–æ–¥–µ–ª—å | –¢–∏–ø |
|---|--------|-----|
| 1 | Popularity | Baseline |
| 2 | GCN | Graph Neural Network |
| 3 | DAGNN | DAG Neural Network |
| 4 | DAGNN-Improved | GNN + Focal Loss |
| 5 | GraphSAGE | Graph Neural Network |
| 6 | GRU4Rec | Recurrent (Sequential) |
| 7 | SASRec | Self-Attention (Sequential) |
| 8 | Caser | CNN (Sequential) |
| 9 | DAGNNSequential | Hybrid (DAGNN + GRU) |
| 10 | DAGNNAttention | Hybrid (DAGNN + Attention) |

### ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏

–î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è:
- **Accuracy** - —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **F1-score** - –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ precision –∏ recall
- **Precision** - —Ç–æ—á–Ω–æ—Å—Ç—å
- **Recall** - –ø–æ–ª–Ω–æ—Ç–∞
- **nDCG** - normalized Discounted Cumulative Gain (–∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è)

–í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ: **Mean ¬± Std**

### ‚úÖ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **Stratified K-Fold**: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ seeds**: –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ–ª–¥–µ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º seed
- **–ê–≥—Ä–µ–≥–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ mean –∏ std –ø–æ –≤—Å–µ–º —Ñ–æ–ª–¥–∞–º
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö:
1. –ù–∞—á–Ω–∏—Ç–µ —Å **README.md** - –∫—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã `run_cross_validation.sh` –∏–ª–∏ `run_quick_cv.sh`

### –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö:
1. **CROSS_VALIDATION_GUIDE.md** - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
2. **CV_OUTPUT_EXAMPLE.md** - –ø—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
3. **CHANGELOG_CV.md** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è |
|--------------|----------------------|
| 3 —Ñ–æ–ª–¥–∞, 100 —ç–ø–æ—Ö | ~30 –º–∏–Ω—É—Ç |
| 3 —Ñ–æ–ª–¥–∞, 200 —ç–ø–æ—Ö | ~45 –º–∏–Ω—É—Ç |
| 5 —Ñ–æ–ª–¥–æ–≤, 100 —ç–ø–æ—Ö | ~50 –º–∏–Ω—É—Ç |
| 5 —Ñ–æ–ª–¥–æ–≤, 200 —ç–ø–æ—Ö | ~70 –º–∏–Ω—É—Ç |

*–í—Ä–µ–º—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç hardware (CPU/GPU)*

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –±—ã—Å—Ç—Ä—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:
```bash
./run_quick_cv.sh compositionsDAG.json
# 3 —Ñ–æ–ª–¥–∞, 100 —ç–ø–æ—Ö - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ ~30 –º–∏–Ω—É—Ç
```

### –î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
```bash
./run_cross_validation.sh compositionsDAG.json 5 200
# 5 —Ñ–æ–ª–¥–æ–≤, 200 —ç–ø–æ—Ö - –Ω–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

### –î–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```bash
python sequence_dag_recommender_final.py --data compositionsDAG.json --epochs 50
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º, –±—ã—Å—Ç—Ä—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

---

## üìä –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```
üèÜ –ò–¢–û–ì–û–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ö–†–û–°–°-–í–ê–õ–ò–î–ê–¶–ò–ò (Mean ¬± Std)

#1 DAGNN-Improved (Focal)
  accuracy    : 0.5420 ¬± 0.0287  ‚Üê –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∏–π —Ä–∞–∑–±—Ä–æ—Å ‚úÖ
  ndcg        : 0.7456 ¬± 0.0189  ‚Üê –û—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ

#2 DAGNNSequential (DAGNN+GRU)
  accuracy    : 0.5380 ¬± 0.0301
  ndcg        : 0.7423 ¬± 0.0201

... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏)

ü•á Best Model (Accuracy): DAGNN-Improved (Focal)
ü•á Best Model (nDCG):     DAGNN-Improved (Focal)
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- Mean –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω—é—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Std –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (—á–µ–º –º–µ–Ω—å—à–µ - —Ç–µ–º –ª—É—á—à–µ)
- Low std –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –º–æ–¥–µ–ª—å

---

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:
- `--data` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏:
- `--use-cv` - –≤–∫–ª—é—á–∏—Ç—å CV —Ä–µ–∂–∏–º
- `--cv-folds N` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ–ª–¥–æ–≤ (3, 5, 10)

### –û–±—â–∏–µ:
- `--epochs N` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö (50-200)
- `--hidden-channels N` - —Ä–∞–∑–º–µ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è (32-128)
- `--learning-rate F` - learning rate (0.0001-0.01)
- `--dropout F` - dropout rate (0.2-0.5)
- `--random-seed N` - random seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏

---

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏

### Vs –ø—Ä–æ—Å—Ç–æ–π train/test split:

| –ê—Å–ø–µ–∫—Ç | Train/Test Split | Cross-Validation |
|--------|------------------|------------------|
| –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| –°–∫–æ—Ä–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CV:**
- ‚úÖ –î–ª—è —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- ‚úÖ –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
- ‚úÖ –î–ª—è –º–∞–ª—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π split:**
- ‚úÖ –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –î–ª—è –±—ã—Å—Ç—Ä—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- ‚úÖ –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- ‚úÖ –ü—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## üÜò –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–æ–±–ª–µ–º—ã?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **CROSS_VALIDATION_GUIDE.md** ‚Üí —Ä–∞–∑–¥–µ–ª "Troubleshooting"
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ **CV_OUTPUT_EXAMPLE.md** –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `compositionsDAG.json`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (—Å–º. `requirements.txt`)

### –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:

**"Too few samples for stratification"**
‚Üí –£–º–µ–Ω—å—à–∏—Ç–µ `--cv-folds` –¥–æ 3 –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º

**Out of memory**
‚Üí –£–º–µ–Ω—å—à–∏—Ç–µ `--hidden-channels` –∏–ª–∏ `--cv-folds`

**–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ**
‚Üí –£–º–µ–Ω—å—à–∏—Ç–µ `--epochs` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--cv-folds 3`

---

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–í—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ. –ù–∞—á–Ω–∏—Ç–µ —Å:

```bash
./run_quick_cv.sh compositionsDAG.json
```

–≠—Ç–æ –∑–∞–π–º–µ—Ç –æ–∫–æ–ª–æ 30 –º–∏–Ω—É—Ç –∏ –¥–∞—Å—Ç –≤–∞–º –Ω–∞–¥–µ–∂–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π.

**–£–¥–∞—á–∏ –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö! üöÄ**

