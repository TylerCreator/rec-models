# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏

## –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞

```bash
python sequence_dag_recommender_final.py --data compositionsDAG.json --use-cv --cv-folds 5 --epochs 200
```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
======================================================================
üîÑ STARTING 5-FOLD CROSS-VALIDATION FOR ALL MODELS
======================================================================

======================================================================
üìä FOLD 1/5
======================================================================

Fold 1: Train samples = 100, Test samples = 25
Train class distribution: Counter({0: 15, 1: 12, 2: 10, 3: 8, ...})
Test class distribution: Counter({0: 4, 1: 3, 2: 2, 3: 2, ...})

[Fold 1] Training Popularity baseline...
==================================================
üìä Popularity (Fold 1) Metrics
==================================================
Accuracy:  0.3200
F1-score:  0.0533
Precision: 0.0320
Recall:    0.0667
nDCG:      0.5123

[Fold 1] Training GCN...
GCN Training: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 200/200 [00:08<00:00, 24.15it/s]
==================================================
üìä GCN (Fold 1) Metrics
==================================================
Accuracy:  0.4800
F1-score:  0.4234
Precision: 0.4567
Recall:    0.4012
nDCG:      0.6845

[Fold 1] Training DAGNN...
DAGNN Training: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 200/200 [00:07<00:00, 27.43it/s]
==================================================
üìä DAGNN (Fold 1) Metrics
==================================================
Accuracy:  0.5200
F1-score:  0.4876
Precision: 0.5123
Recall:    0.4678
nDCG:      0.7234

... (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –∏ –≤—Å–µ—Ö —Ñ–æ–ª–¥–æ–≤) ...

======================================================================
üìä FOLD 5/5
======================================================================

... (–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ñ–æ–ª–¥–µ) ...

======================================================================
üìä AGGREGATING RESULTS ACROSS ALL 5 FOLDS
======================================================================

==========================================================================================
üèÜ –ò–¢–û–ì–û–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ö–†–û–°–°-–í–ê–õ–ò–î–ê–¶–ò–ò (Mean ¬± Std)
==========================================================================================

==========================================================================================
#1 DAGNN-Improved (Focal)
==========================================================================================
  accuracy    : 0.5420 ¬± 0.0287
  f1          : 0.5123 ¬± 0.0312
  precision   : 0.5345 ¬± 0.0298
  recall      : 0.4967 ¬± 0.0334
  ndcg        : 0.7456 ¬± 0.0189

==========================================================================================
#2 DAGNNSequential (DAGNN+GRU)
==========================================================================================
  accuracy    : 0.5380 ¬± 0.0301
  f1          : 0.5089 ¬± 0.0289
  precision   : 0.5298 ¬± 0.0312
  recall      : 0.4923 ¬± 0.0345
  ndcg        : 0.7423 ¬± 0.0201

==========================================================================================
#3 DAGNN
==========================================================================================
  accuracy    : 0.5280 ¬± 0.0267
  f1          : 0.4987 ¬± 0.0298
  precision   : 0.5189 ¬± 0.0301
  recall      : 0.4823 ¬± 0.0312
  ndcg        : 0.7345 ¬± 0.0178

==========================================================================================
#4 GRU4Rec
==========================================================================================
  accuracy    : 0.5240 ¬± 0.0289
  f1          : 0.4956 ¬± 0.0312
  precision   : 0.5156 ¬± 0.0298
  recall      : 0.4789 ¬± 0.0334
  ndcg        : 0.7312 ¬± 0.0201

==========================================================================================
#5 GCN
==========================================================================================
  accuracy    : 0.5180 ¬± 0.0298
  f1          : 0.4912 ¬± 0.0289
  precision   : 0.5123 ¬± 0.0312
  recall      : 0.4734 ¬± 0.0301
  ndcg        : 0.7289 ¬± 0.0167

==========================================================================================
#6 DAGNNAttention (DAGNN+Attn)
==========================================================================================
  accuracy    : 0.5120 ¬± 0.0312
  f1          : 0.4867 ¬± 0.0298
  precision   : 0.5078 ¬± 0.0289
  recall      : 0.4689 ¬± 0.0323
  ndcg        : 0.7234 ¬± 0.0189

==========================================================================================
#7 GraphSAGE
==========================================================================================
  accuracy    : 0.5060 ¬± 0.0289
  f1          : 0.4823 ¬± 0.0312
  precision   : 0.5034 ¬± 0.0298
  recall      : 0.4645 ¬± 0.0334
  ndcg        : 0.7198 ¬± 0.0178

==========================================================================================
#8 SASRec
==========================================================================================
  accuracy    : 0.4580 ¬± 0.0334
  f1          : 0.4234 ¬± 0.0312
  precision   : 0.4456 ¬± 0.0289
  recall      : 0.4089 ¬± 0.0345
  ndcg        : 0.6756 ¬± 0.0201

==========================================================================================
#9 Caser
==========================================================================================
  accuracy    : 0.4420 ¬± 0.0312
  f1          : 0.4123 ¬± 0.0298
  precision   : 0.4345 ¬± 0.0312
  recall      : 0.3956 ¬± 0.0334
  ndcg        : 0.6634 ¬± 0.0189

==========================================================================================
#10 Popularity
==========================================================================================
  accuracy    : 0.3280 ¬± 0.0298
  f1          : 0.0567 ¬± 0.0089
  precision   : 0.0328 ¬± 0.0067
  recall      : 0.0733 ¬± 0.0123
  ndcg        : 0.5234 ¬± 0.0156

==========================================================================================
üîç –°–¢–ê–¢–ò–°–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó
==========================================================================================
Accuracy - Min:   0.3280
Accuracy - Max:   0.5420
Accuracy - Range: 0.2140
Accuracy - Mean:  0.4896
Accuracy - Std:   0.0623

ü•á Best Model (Accuracy): DAGNN-Improved (Focal) (0.5420 ¬± 0.0287)
ü•á Best Model (nDCG):     DAGNN-Improved (Focal) (0.7456)
==========================================================================================
```

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

1. **Mean (—Å—Ä–µ–¥–Ω–µ–µ)** - —Å—Ä–µ–¥–Ω—è—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –ø–æ –≤—Å–µ–º —Ñ–æ–ª–¥–∞–º
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
   
2. **Std (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)** - —Ä–∞–∑–±—Ä–æ—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–µ–∂–¥—É —Ñ–æ–ª–¥–∞–º–∏
   - –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –º–æ–¥–µ–ª—å
   - –ù–∏–∑–∫–æ–µ std —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–º–µ—Ä–∞

- **DAGNN-Improved (Focal)** - –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å:
  - Accuracy: 0.5420 ¬± 0.0287 (–≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∏–π —Ä–∞–∑–±—Ä–æ—Å)
  - nDCG: 0.7456 ¬± 0.0189 (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è)
  - –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (std < 0.03)

- **Popularity baseline** - —Ö—É–¥—à–∞—è –º–æ–¥–µ–ª—å:
  - Accuracy: 0.3280 ¬± 0.0298 (–Ω–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)
  - nDCG: 0.5234 ¬± 0.0156 (–ø–ª–æ—Ö–æ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - –°–ª—É–∂–∏—Ç –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏

–°—Ä–∞–≤–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç—ã–º train/test split:

**–ü—Ä–æ—Å—Ç–æ–π split:**
```
Accuracy: 0.5200
```

**Cross-validation:**
```
Accuracy: 0.5420 ¬± 0.0287
```

–ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–µ—Ç:
- ‚úÖ –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—É—é –æ—Ü–µ–Ω–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ (std)
- ‚úÖ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –≤—ã–±–æ—Ä–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
- ‚úÖ –ó–∞—â–∏—Ç—É –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–î–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ (5 —Ñ–æ–ª–¥–æ–≤, 200 —ç–ø–æ—Ö, 10 –º–æ–¥–µ–ª–µ–π):
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: ~60-70 –º–∏–Ω—É—Ç
- **–ù–∞ –º–æ–¥–µ–ª—å**: ~6-7 –º–∏–Ω—É—Ç
- **–ù–∞ —Ñ–æ–ª–¥**: ~12-14 –º–∏–Ω—É—Ç

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--cv-folds 3` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è (~40 –º–∏–Ω—É—Ç)
- –£–º–µ–Ω—å—à–∏—Ç–µ `--epochs 100` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (~30 –º–∏–Ω—É—Ç)

